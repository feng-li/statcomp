t0<-t(matrix(c(0.5,1,
             1.5,-1,
             1,3),2,3))

pdf('nm0.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Nelder Mead",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0,lwd=2)
dev.off()

pdf('nmf.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Evaluate Functions",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0,lwd=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
dev.off()


pdf('nmcent.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Centroid",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
cent<-apply(t0[c(1,2),],2,mean)
points(cent[1],cent[2],col='red',pch=16,cex=2)
dev.off()

pdf('nmrefl.pdf')
alpha<-1
vrefl<-cent+alpha*(cent-t0[3,])
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Reflection",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
lines(c(t0[3,1],vrefl[1]),c(t0[3,2],vrefl[2]),col='red',lwd=2,lty=2)
#points(vrefl[1],vrefl[2],pch=17,col='red')
points(cent[1],cent[2],col='red',pch=1,cex=2)
dev.off()


pdf('nmrefl1.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Reflection",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
lines(c(t0[3,1],vrefl[1]),c(t0[3,2],vrefl[2]),col='red',lwd=2,lty=2)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)

dev.off()

pdf('nmrefl2.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Case 1",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
lines(c(t0[3,1],vrefl[1]),c(t0[3,2],vrefl[2]),col='red',lwd=2,lty=2)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vrefl[1],vrefl[2],'f=2',pos=4,cex=2)

dev.off()

pdf('nmrefl3.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Case 1",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
lines(c(t0[3,1],vrefl[1]),c(t0[3,2],vrefl[2]),col='red',lwd=2,lty=2)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
polygon(rbind(t0[c(1,2),],vrefl),border='magenta',lwd=4)
dev.off()

pdf('nmexpansion1.pdf')
gamma<-2
vexp<-cent+gamma*(vrefl-cent)
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Case 2",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
lines(c(t0[3,1],vrefl[1]),c(t0[3,2],vrefl[2]),col='red',lwd=2,lty=2)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vrefl[1],vrefl[2],'f=0',pos=4,cex=2)
dev.off()

pdf('nmexpansion2.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Case 2",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vexp[1]),c(t0[3,2],vexp[2]),col='blue',lwd=2,lty=2)
points(vexp[1],vexp[2],pch=17,col='blue',cex=2)
dev.off()

pdf('nmexpansion3.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Case 2",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vexp[1]),c(t0[3,2],vexp[2]),col='blue',lwd=2,lty=2)
points(vexp[1],vexp[2],pch=17,col='blue',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vrefl[1],vrefl[2],'f=0',pos=4,cex=2)
text(vexp[1],vexp[2],'f=-1',pos=4,cex=2)
polygon(rbind(t0[c(1,2),],vexp),border='magenta',lwd=4)
dev.off()

pdf('nmexpansion4.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-7,6),pch=18,main="Case 2",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vexp[1]),c(t0[3,2],vexp[2]),col='blue',lwd=2,lty=2)
points(vexp[1],vexp[2],pch=17,col='blue',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vrefl[1],vrefl[2],'f=0',pos=4,cex=2)
text(vexp[1],vexp[2],'f=3',pos=4,cex=2)
polygon(rbind(t0[c(1,2),],vrefl),border='magenta',lwd=4)
dev.off()

pdf('nmcontraction1.pdf')
rho<-0.5
vcont<-cent+rho*(t0[3,]-cent)
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-4,6),pch=18,main="Case 3",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
lines(c(t0[3,1],vrefl[1]),c(t0[3,2],vrefl[2]),col='red',lwd=2,lty=2)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vrefl[1],vrefl[2],'f=5',pos=4,cex=2)
dev.off()

pdf('nmcontraction2.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-4,6),pch=18,main="Case 3",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vcont[1]),c(t0[3,2],vcont[2]),col='green',lwd=2,lty=2)
points(vcont[1],vcont[2],pch=17,col='green',cex=2)
dev.off()

pdf('nmcontraction3.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-4,6),pch=18,main="Case 3",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vcont[1]),c(t0[3,2],vcont[2]),col='green',lwd=2,lty=2)
points(vcont[1],vcont[2],pch=17,col='green',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vcont[1],vcont[2],'f=3',pos=4,cex=2)
polygon(rbind(t0[c(1,2),],vcont),border='magenta',lwd=4)
dev.off()

pdf('nmshrink1.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-4,6),pch=18,main="Case 3",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
#points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vcont[1]),c(t0[3,2],vcont[2]),col='green',lwd=2,lty=2)
points(vcont[1],vcont[2],pch=17,col='green',cex=2)
text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
text(vcont[1],vcont[2],'f=9',pos=4,cex=2)
#polygon(rbind(t0[c(1,2),],vcont),border='magenta',lwd=4)
dev.off()

sigma<-0.5
tshr<-t0
for (j in 1:3){
  tshr[j,]<-t0[2,]+rho*(t0[j,]-t0[2,])  
}
pdf('nmshrink2.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-4,6),pch=18,main="Case 3",xlab=expression(x[1]),ylab=expression(x[2]))
polygon(t0)
#points(cent[1],cent[2],col='red',pch=1,cex=2)
points(vrefl[1],vrefl[2],pch=17,col='red',cex=2)
lines(c(t0[3,1],vcont[1]),c(t0[3,2],vcont[2]),col='green',lwd=2,lty=2)
points(vcont[1],vcont[2],pch=17,col='green',cex=2)
#text(t0[1,1],t0[1,2],'f=4',pos=2,cex=2)
#text(t0[2,1],t0[2,2],'f=1',pos=4,cex=2)
#text(t0[3,1],t0[3,2],'f=6',pos=3,cex=2)
#text(vcont[1],vcont[2],'f=3',pos=4,cex=2)
polygon(tshr,border='magenta',lwd=4)
dev.off()


Workers<-seq(1,200,1)
Income<-8-(1/1000)*(Workers-100)^2
pdf('contfunc.pdf')
plot(Workers,Income,'l',main='Continuous Function')
dev.off()
Income[Workers>50]<-Income[Workers>50]-3

pdf('discontfunc.pdf')
plot(Workers,Income,'l',main='Discontinuous Function')
dev.off()

t0<-t(matrix(c(0.5,1,
               1.5,2,
               1,3),2,3))

pdf('geom1.pdf')
plot(t0[,1],t0[,2],xlim=c(0,2),ylim=c(-2,4),pch=18,main="Volume",xlab='',ylab='')
polygon(t0,lwd=2)
text(t0[2,1],t0[2,2],expression(x[1]),pos=4)
text(t0[3,1],t0[3,2],expression(x[2]),pos=4)
text(t0[1,1],t0[1,2],expression(x[3]),pos=1)
dev.off()

pdf('geom2.pdf')
for(j in 3:1){t0[j,]<-t0[j,]-t0[1,]}
plot(t0[,1],t0[,2],xlim=c(-0.5,1.5),ylim=c(-3,3),pch=18,main="Volume",xlab='',ylab='')
polygon(t0,lwd=2)
text(t0[2,1],t0[2,2],expression(x[1]-x[3]),pos=4)
text(t0[3,1],t0[3,2],expression(x[2]-x[3]),pos=4)
dev.off()

pdf('geom3.pdf')
t0<-rbind(t0,t0[3,]+t0[2,])
plot(t0[,1],t0[,2],xlim=c(-0.5,1.5),ylim=c(-3,3),pch=18,main="Volume",xlab='',ylab='')
polygon(t0[c(1,3,4,2),],lwd=2,col='red')
dev.off()

pdf('geom4.pdf')
plot(t0[,1],t0[,2],xlim=c(-0.5,1.5),ylim=c(-3,3),pch=18,main="Volume",xlab='',ylab='')
polygon(t0[c(1,3,4,2),],lwd=2,col='red')
polygon(t0[1:3,],lwd=2,col='blue')
dev.off()
